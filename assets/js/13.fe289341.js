(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{263:function(t,a,r){"use strict";r.r(a);var s=r(4),e=Object(s.a)({},function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"openwrt-基础"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#openwrt-基础","aria-hidden":"true"}},[t._v("#")]),t._v(" OpenWrt 基础 "),r("Badge",{attrs:{text:"整理中",type:"warn"}})],1),t._v(" "),r("h2",{attrs:{id:"flash分区"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#flash分区","aria-hidden":"true"}},[t._v("#")]),t._v(" Flash分区")]),t._v(" "),r("p",[t._v("Linux系统对闪存类存储器是采用MTD设备驱动实现的。")]),t._v(" "),r("div",{staticClass:"language-bash line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u-boot"')]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"u-boot-env"')]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"factory"')]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"firmware"')]),t._v("\n"),r("span",{pre:!0,attrs:{class:"token keyword"}},[t._v(":")]),r("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rootfs"')]),t._v("\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br"),r("span",{staticClass:"line-number"},[t._v("2")]),r("br"),r("span",{staticClass:"line-number"},[t._v("3")]),r("br"),r("span",{staticClass:"line-number"},[t._v("4")]),r("br"),r("span",{staticClass:"line-number"},[t._v("5")]),r("br")])]),r("div",{staticClass:"tip custom-block"},[r("p",[t._v("系统在SPI设备上创建了4个MTD分区")])]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("分区ID号")]),t._v(" "),r("th",[t._v("分区位置")]),t._v(" "),r("th",[t._v("分区容量")]),t._v(" "),r("th",[t._v("分区作用")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("u-boot")]),t._v(" "),r("td",[t._v("0x00000000-0x00030000")]),t._v(" "),r("td",[t._v("192KB")]),t._v(" "),r("td",[t._v("引导程序")])]),t._v(" "),r("tr",[r("td",[t._v("u-boot-env")]),t._v(" "),r("td"),t._v(" "),r("td"),t._v(" "),r("td",[t._v("引导程序的配置数据")])]),t._v(" "),r("tr",[r("td",[t._v("factory")]),t._v(" "),r("td"),t._v(" "),r("td"),t._v(" "),r("td",[t._v("路由器芯片的初始化参数")])]),t._v(" "),r("tr",[r("td",[t._v("firmware")]),t._v(" "),r("td"),t._v(" "),r("td"),t._v(" "),r("td",[t._v("固件分区")])]),t._v(" "),r("tr",[r("td",[t._v("rootfs")]),t._v(" "),r("td"),t._v(" "),r("td"),t._v(" "),r("td",[t._v("固件分区"),r("br"),t._v("文件系统子集")])]),t._v(" "),r("tr",[r("td",[t._v("rootfs_data")]),t._v(" "),r("td"),t._v(" "),r("td"),t._v(" "),r("td",[t._v("固件分区"),r("br"),t._v("文件系统子集"),r("br"),t._v("可写分区子集")])])])]),t._v(" "),r("p",[r("strong",[t._v("TODO：插入示意图")])]),t._v(" "),r("ul",[r("li",[t._v("分区存在子分区，kernel和rootfs就是firmware的子分区，rootfs_rom和rootfs_data就是rootfs的子分区。")])]),t._v(" "),r("h3",{attrs:{id:"查看系统mtd分配"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#查看系统mtd分配","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看系统MTD分配")]),t._v(" "),r("p",[r("strong",[t._v("TODO：命令 cat /proc/mtd 的结果")])]),t._v(" "),r("h3",{attrs:{id:"查看系统mtd分配-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#查看系统mtd分配-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看系统MTD分配")]),t._v(" "),r("p",[r("strong",[t._v("TODO：命令 cat /proc/partitions的结果")])]),t._v(" "),r("h3",{attrs:{id:"读取-备份factory分区"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#读取-备份factory分区","aria-hidden":"true"}},[t._v("#")]),t._v(" 读取/备份factory分区")]),t._v(" "),r("p",[t._v("factory分区是非文件系统的，里面保存的是配置（如MAC地址，天线匹配参数等）。前文所述，factory分区的设备文件是/dev/mtd2")]),t._v(" "),r("h4",{attrs:{id:"查看分区内容"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#查看分区内容","aria-hidden":"true"}},[t._v("#")]),t._v(" 查看分区内容")]),t._v(" "),r("div",{staticClass:"language-bash line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[t._v("hexdump -C /dev/mtd2\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("h4",{attrs:{id:"备份分区"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#备份分区","aria-hidden":"true"}},[t._v("#")]),t._v(" 备份分区")]),t._v(" "),r("h2",{attrs:{id:"文件系统"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#文件系统","aria-hidden":"true"}},[t._v("#")]),t._v(" 文件系统")])])},[],!1,null,null,null);a.default=e.exports}}]);